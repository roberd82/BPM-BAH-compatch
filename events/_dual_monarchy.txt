namespace = dual_monarchy

# Dual Monarchy event
dual_monarchy.1 = {
	type = country_event

	title = dual_monarchy.1.t
	desc = {
		first_valid = {
			triggered_desc = {
				desc = dual_monarchy.1.d
				trigger = {
					NOT = { has_variable = dual_monarchy_fail }
				}
			}
			triggered_desc = {
				desc = dual_monarchy.1.d2
				trigger = {
					has_variable = dual_monarchy_fail
				}
			}
		}
	}
	flavor = dual_monarchy.1.f

	event_image = {
		video = "unspecific_ruler_speaking_to_people"
	}

	icon = "gfx/interface/icons/event_icons/event_portrait.dds"

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	duration = 3

	trigger = {
		# triggered by dual monarchy JE
	}

	immediate = {
		cu:hungarian = {
			save_scope_as = hungarian_culture
		}
	}

	option = {
		name = dual_monarchy.1.a
		trigger = {
			NOT = { has_variable = dual_monarchy_fail }
		}
		default_option = yes
		custom_tooltip = austria_hungary_tt
		add_primary_culture = cu:hungarian
		if = {
			limit = {
				exists = c:HUN
			}
			annex = c:HUN
		}
		add_loyalists = {
			culture = cu:hungarian
			value = 0.2
		}
		every_interest_group = {
			limit = {
				has_ideology = ideology:ideology_cit_nationalist
			}
			bpm_remove_all_cit_ideologies = yes
			add_ideology = ideology_cit_multiethnic_nationalist
			bpm_reorder_ideologies = yes
		}
		ig:ig_landowners = {
			hidden_effect = {
				set_interest_group_name = ig_landowners
			}
		}
	}
	option = { # accept compromise
		name = dual_monarchy.1.b
		trigger = {
			has_variable = dual_monarchy_fail
		}
		custom_tooltip = austria_hungary_tt
		add_primary_culture = cu:hungarian
		if = {
			limit = {
				exists = c:HUN
			}
			annex = c:HUN
		}
		every_interest_group = {
			limit = {
				has_ideology = ideology:ideology_cit_nationalist
			}
			bpm_remove_all_cit_ideologies = yes
			add_ideology = ideology_cit_multiethnic_nationalist
			bpm_reorder_ideologies = yes
		}
		ig:ig_landowners = {
			hidden_effect = {
				set_interest_group_name = ig_landowners
			}
		}
		add_radicals = {
			value = large_radicals
			culture = cu:south_german
			pop_type = aristocrats
		}
		# lose prestige
		add_modifier = {
			name = dual_monarchy_compromise
			months = very_long_modifier_time
		}
	}
	option = { #reject compromise
		name = dual_monarchy.1.c
		trigger = {
			has_variable = dual_monarchy_fail
		}
		if = {
			limit = {
				exists = c:HUN
			}
			set_relations = { country = c:HUN value = -35 }
		}
		else = {
			add_radicals = {
				value = very_large_radicals
				culture = cu:hungarian
			}
			# add radicals from discrimination
			every_scope_state = {
				limit = {
					state_region = {
						is_homeland = cu:hungarian
					}
				}
				add_modifier = {
					name = dual_monarchy_compromise_rejected
					months = long_modifier_time
				}
			}
		}
	}
}

#Liberals in Hungarian Government,
#stop them or let them be
dual_monarchy.2 = {
	type = country_event

	title = dual_monarchy.2.t
	desc = dual_monarchy.2.d
	flavor = dual_monarchy.1.f

	event_image = {
		video = "gfx/event_pictures/unspecific_ruler_speaking_to_people.bk2"
	}

	icon = "gfx/interface/icons/event_icons/event_portrait.dds"

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/unspecific/leader_speaking_to_a_group_of_people"

	duration = 3

	trigger = { # triggered from betterah_hungary.2
		NOT = {
			is_diplomatic_play_enemy_of = c:HUN
		}
	}

	option = { # try to annex Hungary
		name = dual_monarchy.2.a
		default_option = yes
		
		create_diplomatic_play = {
			name = hungarian_revolution
			war = no
			type = dp_annex_war

			target_state = s:STATE_CENTRAL_HUNGARY.region_state:HUN

			add_war_goal = {
				holder = c:HUN
				type = independence
				target_country = c:AUS
			}
		}
	}
	option = { # let them be for now
		name = dual_monarchy.2.b

		add_radicals = { # aristocrats angry that we don't keep hungary in check
			value = large_radicals
			culture = cu:south_german
			pop_type = aristocrats
		}
	}
}

#April Laws in Hungarian Government,
#stop them or let them be
dual_monarchy.3 = {
	type = country_event

	title = dual_monarchy.3.t
	desc = dual_monarchy.3.d
	flavor = dual_monarchy.1.f

	event_image = {
		video = "gfx/event_pictures/unspecific_ruler_speaking_to_people.bk2"
	}

	icon = "gfx/interface/icons/event_icons/event_portrait.dds"

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/unspecific/leader_speaking_to_a_group_of_people"

	duration = 3

	trigger = {
		# Triggered by hungarian april laws event
		NOT = {
			is_diplomatic_play_enemy_of = c:HUN
		}
	}

	option = { # try to annex Hungary
		name = dual_monarchy.3.a
		default_option = yes
		
		create_diplomatic_play = {
			name = hungarian_revolution
			war = no
			type = dp_annex_war

			target_state = s:STATE_CENTRAL_HUNGARY.region_state:HUN

			add_war_goal = {
				holder = c:HUN
				type = independence
				target_country = c:AUS
			}
		}
	}
	option = { # let them be for now
		name = dual_monarchy.3.b

		add_radicals = { # aristocrats angry that we don't keep hungary in check
			value = large_radicals
			culture = cu:south_german
			pop_type = aristocrats
		}
	}
}
